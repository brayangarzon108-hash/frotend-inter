<div class="flex flex-col items-stretch scrollbar-thin">
  <p-toast />

  <!-- WRAPPER -->
  <div class="w-full max-w-7xl mx-auto">
    <!-- HEADER -->
    <div class="w-full flex flex-col lg:flex-row justify-between items-start lg:items-end gap-4">
      <!-- IZQUIERDA -->
      <div class="flex flex-col gap-4">
        <div class="title-module text-3xl sm:text-xl md:text-[1.8em]">Lista de Estudiantes</div>

        <form [formGroup]="filterCatalog" class="flex flex-row items-end gap-3 filters">
          <div class="flex flex-col w-[220px]">
            <label class="label-filters">Nombre del estudiante: </label>
            <input
              pInputText
              formControlName="nameCatalog"
              autocomplete="off"
              placeholder="Ingrese nombre del estudiante"
            />
          </div>

          <div class="flex flex-row gap-2">
            <p-button
              [rounded]="true"
              severity="warn"
              [text]="true"
              icon="pi pi-search"
              (onClick)="getCatalog(filterCatalog.value)"
            />
            <p-button
              [rounded]="true"
              severity="warn"
              [text]="true"
              icon="pi pi-eraser"
              (onClick)="clearFilter()"
            />
          </div>
        </form>
      </div>

      <!-- BOTÓN DERECHA -->
      <p-button
        label="Crear Catálogo"
        icon="pi pi-clipboard"
        iconPos="right"
        severity="warn"
        class="self-start lg:self-end"
        (onClick)="openModalForm(null, true)"
      />
    </div>

    <!-- TOTAL -->
    <div class="mt-6 font-semibold text-right">Total de registros: {{ totalRecords }}</div>

    <!-- TABLA -->
    <p-table
      class="mt-4"
      [value]="formsList"
      [paginator]="true"
      [rows]="20"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Total de registros: {totalRecords}"
      [scrollable]="true"
    >
      <ng-template #header>
        <tr>
          <th
            style="min-width: 80px; text-align: center"
            class="hidden sm:hidden md:hidden lg:table-cell"
          >
            ID
          </th>
          <th style="min-width: 150px; text-align: center">Nombre</th>

          <th
            style="min-width: 200px; text-align: center"
            class="hidden sm:hidden md:table-cell lg:table-cell"
          >
            Descripción
          </th>
          <th
            style="min-width: 100px; text-align: center"
            class="hidden sm:hidden md:hidden lg:table-cell"
          >
            Estado
          </th>
          <th style="min-width: 150px; text-align: center">Acciones</th>
        </tr>
      </ng-template>
      <ng-template #body let-forms>
        <tr>
          <td style="text-align: center" class="hidden sm:hidden md:hidden lg:table-cell">
            {{ forms.catalogId }}
          </td>
          <td style="text-align: center">
            {{ forms.catalogName }}
          </td>
          <td style="text-align: center" class="hidden sm:hidden md:table-cell lg:table-cell">
            {{ forms.description }}
          </td>
          <td style="text-align: center" class="hidden sm:hidden md:hidden lg:table-cell">
            <div class="md:flex flex-row items-center justify-center">
              <p-tag
                class="ms-2"
                [value]="forms.enabled ? 'Activo' : 'Inactivo'"
                [severity]="forms.enabled ? 'success' : 'danger'"
              />
            </div>
          </td>
          <td style="text-align: center">
            <div class="md:flex flex-row items-center justify-center">
              <p-button
                [rounded]="true"
                [text]="true"
                icon="pi pi-eye"
                (onClick)="openModalForm(forms, false)"
                pTooltip="Visualizacion"
                class="inline-block sm:inline-block md:inline-block lg:hidden"
              />
              <p-button
                [rounded]="true"
                [text]="true"
                icon="pi pi-pen-to-square"
                pTooltip="Edición"
                tooltipPosition="left"
                (onClick)="openModalForm(forms, true)"
              />
              <p-button
                [rounded]="true"
                [text]="true"
                icon="pi pi-list"
                pTooltip="Items"
                tooltipPosition="left"
                (onClick)="openModalItem(forms.catalogId)"
              />
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

@if (handleCatalogModal) {
  <app-modal-student-list
    [data]="dataCatalog"
    [visible]="handleCatalogModal"
    [visibility]="visibilityModal"
    (close)="closeDialog()"></app-modal-student-list>
}

  <!--
@if (handleItemModal) {
  <app-modal-create-items
    [dynamicCatalogId]="dynamicCatalogId"
    [visible]="true"
    (close)="closeDialogItem()"></app-modal-create-items>
}
  -->
  @if (handleLoading) {
    <div class="spinner-overlay">
      <p-progress-spinner ariaLabel="loading" />
    </div>
  }
</div>
